import java.io.File;
import java.io.FileReader;
import java.io.BufferedReader;
import java.io.IOException;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import java.util.Iterator;
import com.opencsv.CSVReader;

public class FileProcessor {
    
    public static void processFiles(File[] listOfFiles) {
        for (File file : listOfFiles) {
            if (file.isFile()) {
                String fileName = file.getName();
                String extension = fileName.substring(fileName.lastIndexOf(".") + 1).toLowerCase();
                
                try {
                    switch (extension) {
                        case "xlsx":
                            processExcelFile(file);
                            break;
                        case "csv":
                            processCsvFile(file);
                            break;
                        case "txt":
                            processTextFile(file);
                            break;
                        default:
                            System.out.println("Unsupported file type: " + fileName);
                            break;
                    }
                    // 기록 남기기 (성공)
                    System.out.println("Successfully processed: " + fileName);
                } catch (Exception e) {
                    // 기록 남기기 (실패)
                    System.out.println("Failed to process: " + fileName);
                    e.printStackTrace();
                }
            }
        }
    }
    
    private static void processExcelFile(File file) throws IOException {
        try (Workbook workbook = WorkbookFactory.create(file)) {
            Sheet sheet = workbook.getSheetAt(0);
            for (Row row : sheet) {
                // 예시: 첫 번째 컬럼의 값을 읽어옴
                Cell cell = row.getCell(0);
                System.out.println("Excel Cell Value: " + cell.toString());
            }
        }
    }

    private static void processCsvFile(File file) throws IOException {
        try (CSVReader csvReader = new CSVReader(new FileReader(file))) {
            String[] nextRecord;
            while ((nextRecord = csvReader.readNext()) != null) {
                // 예시: 첫 번째 컬럼의 값을 읽어옴
                System.out.println("CSV Cell Value: " + nextRecord[0]);
            }
        }
    }

    private static void processTextFile(File file) throws IOException {
        try (BufferedReader reader = new BufferedReader(new FileReader(file))) {
            String line;
            while ((line = reader.readLine()) != null) {
                // 예시: 파일의 각 라인을 출력
                System.out.println("Text Line: " + line);
            }
        }
    }
    
    public static void main(String[] args) {
        File folder = new File("path/to/your/folder");
        File[] listOfFiles = folder.listFiles();
        processFiles(listOfFiles);
    }
}
